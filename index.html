<!DOCTYPE html>
<html ng-app="app">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Patagonia House - Sistema de Reservas</title>
    
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/angular-material/1.1.1/angular-material.min.css" />
    <link rel="stylesheet" type="text/css" href="/styles.css" />
    
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular-animate.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular-aria.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular-route.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-material/1.1.1/angular-material.min.js"></script>
    <script src="https://apis.google.com/js/client.js"></script>
    <script src="/polyfill-array-find.js"></script>
    <script src="/app.js"></script>
    <script src="/config-controller.js"></script>
    <script src="/gapi-service.js"></script>
    <script src="/utils.js"></script>
    <script src="/sheets.js"></script>
    <script src="/entry-controller.js"></script>
  </head>
  
  <body>
    <div layout-padding>
      <div ng-controller="ConfigController" ng-hide="configComplete" class="base-container md-whiteframe-z1">
        <md-toolbar class="md-primary">
          <div class="md-toolbar-tools">
            <h2>Configuración</h2>
          </div>
        </md-toolbar>

        <form ng-submit="saveConfig()">
          <div layout="row">
            <md-input-container>
              <label>Porcentaje de impuesto</label>
              <input type="number" min="0" max="100" ng-model="config.taxPercentage" />
            </md-input-container>
          </div>

          <div layout="row">
            <md-input-container flex>
              <label>Identificación de API Google</label>
              <input type="text" ng-model="config.apiClientId" />
            </md-input-container>
          </div>

          <div layout="row">
            <md-input-container flex>
              <label>ID de lista de reservas</label>
              <input type="text" ng-model="config.bookingSheetId" />
            </md-input-container>

            <md-input-container flex>
              <label>Nombre de la hoja en la lista de reservas</label>
              <input type="text" ng-model="config.bookingSheet" />
            </md-input-container>
          </div>

          <div layout="row">
            <md-input-container flex>
              <label>ID de calendario de reservas</label>
              <input type="text" ng-model="config.roomsSheetId" />
            </md-input-container>
          </div>
          
          <div layout="row">
            <md-checkbox ng-model="config.remember" class="md-primary">Recordar configuración en este navegador</md-checkbox>
          </div>

          <div layout="row" layout-align="start center">
            <md-button type="submit" class="md-raised md-primary">Continuar</md-button>
            <md-progress-circular md-mode="indeterminate" md-diameter="25" ng-show="loading"></md-progress-circular>
          </div>
        </form>
      </div>

      <div ng-controller="EntryController" ng-show="configComplete" class="base-container md-whiteframe-z1">
        <md-toolbar class="md-primary">
          <div class="md-toolbar-tools">
            <h2>Agregar Reserva</h2>
          </div>
        </md-toolbar>

        <form ng-submit="addEntry()">
          <div layout="row">
            <md-input-container flex>
              <label>Nombre</label>
              <input type="text" ng-model="entry.name" autofocus />
            </md-input-container>

            <md-input-container flex>
              <label>Fuente</label>
              <md-select ng-model="entry.source">
                <md-option value="[D]">Directo</md-option>
                <md-option value="[H]">Hostelworld</md-option>
                <md-option value=[B]"">Booking</md-option>
              </md-select>
            </md-input-container>
          </div>
          
          <div layout="row">
            <md-input-container flex>
              <label>Fecha de check-in</label>
              <md-datepicker ng-model="entry.date" ng-change="checkRooms()"></md-datepicker>
            </md-input-container>

            <md-input-container flex>
              <label>Cantidad de personas</label>
              <input type="number" min="1" max="10" ng-model="entry.number" ng-change="checkRooms()" />
            </md-input-container>
            
            <md-input-container flex>
              <label>Días</label>
              <input type="number" min="1" ng-model="entry.days" ng-change="checkRooms()" />
            </md-input-container>

            <md-input-container flex>
              <label>Tipo de habitación</label>
              <input type="number" min="0" ng-model="entry.roomType" />
            </md-input-container>

            <md-input-container flex>
              <label>Hora de llegada</label>
              <input type="number" min="0" max="24" ng-model="entry.arrivalHour" />
            </md-input-container>
          </div>
          
          <div layout="row" layout-align="start center">
            <md-input-container flex>
              <label>Habitaciones disponibles</label>
              <md-select ng-model="entry.room" ng-disabled="roomList.length < 1">
                <md-option ng-repeat="room in roomList" ng-value="room">{{ room.name }} (#{{ room.beds.length }}) - {{ room.availableBeds.length }} disp.</md-option>
              </md-select>
            </md-input-container>

            <div>
              <md-button type="button" ng-click="checkRooms()" ng-disabled="roomsLoading">Volver a buscar</md-button>
            </div>

            <md-progress-circular md-mode="indeterminate" md-diameter="20" ng-class="{ invisible: !roomsLoading }"></md-progress-circular>
          </div>

          <div layout="row">
            <md-input-container flex>
              <label>Precio sin impuesto</label>
              <input type="number" ng-model="entry.priceWithoutTax" ng-change="updatePrice()" />
            </md-input-container>

            <md-input-container flex>
              <label>Precio con impuesto</label>
              <input type="number" ng-model="entry.priceWithTax" />
            </md-input-container>
          </div>

          <div layout="row">
            <md-input-container flex>
              <label>País</label>
              <input type="text" ng-model="entry.country" />
            </md-input-container>
          </div>

          <div layout="row">
            <md-input-container flex>
              <label>Tarjeta de crédito</label>
              <input type="text" ng-model="entry.cardNumber" />
            </md-input-container>
          </div>

          <div layout="row">
            <md-input-container flex>
              <label>Comentarios</label>
              <input type="text" ng-model="entry.comments" />
            </md-input-container>
          </div>

          <div layout="row" layout-align="start center">
            <md-button type="submit" class="md-raised md-primary" ng-disabled="adding">Ingresar reserva</md-button>
            <md-progress-circular md-mode="indeterminate" md-diameter="25" ng-show="adding"></md-progress-circular>
            <md-button type="button" class="md-raised" ng-disabled="adding" ng-click="clear()">Limpiar</md-button>
          </div>
        </form>
      </div>
    </div>
  </body>
</html>
